import pandas as pd
import matplotlib.pyplot as plt
from factor_analyzer.factor_analyzer import calculate_kmo
from factor_analyzer.factor_analyzer import calculate_bartlett_sphericity

# Tus datos
data = {
    "J1": [4, 5, 5, 5, 5, 5, 4, 3, 3, 4, 4, 4, 5, 5, 4, 3, 2, 2, 4, 4, 4, 4, 3, 4, 4, 4, 2, 4, 5, 4, 5, 5, 5, 2, 4, 4, 5, 4, 5, 4, 5, 5, 4, 5, 2, 5, 4, 4, 4, 4, 5, 4, 4, 5, 4, 4, 5, 3, 4, 5, 2, 5, 3, 3, 5, 2, 4, 4, 3, 4, 4, 4, 5, 4, 5, 4, 4, 5, 5, 2, 5, 4, 5, 4, 5, 4, 5, 5, 4, 3, 4, 3, 5, 5, 4, 4, 4, 5, 4, 4, 5, 2, 4, 4, 5, 4, 4, 3, 4, 4, 4, 5, 5, 4, 4, 3, 3, 4, 4, 5, 4, 3, 5, 5, 4, 3, 5, 4, 5, 4, 4, 4, 5, 5, 5, 4, 4, 5, 5, 4, 5, 5, 4, 5, 2, 4, 4],
    "J2": [4, 5, 4, 5, 5, 5, 4, 3, 3, 5, 4, 4, 5, 5, 4, 4, 4, 4, 4, 5, 5, 4, 3, 4, 4, 4, 5, 4, 5, 5, 4, 5, 5, 4, 4, 4, 5, 5, 3, 5, 5, 5, 4, 2, 3, 5, 4, 4, 4, 4, 5, 5, 4, 5, 4, 4, 5, 5, 4, 5, 4, 5, 3, 3, 5, 4, 5, 4, 4, 5, 4, 4, 5, 4, 5, 4, 4, 5, 5, 3, 5, 4, 5, 4, 4, 4, 5, 5, 4, 2, 4, 4, 4, 5, 4, 4, 3, 5, 4, 4, 4, 2, 3, 4, 5, 4, 4, 5, 4, 4, 4, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 5, 5, 3, 3, 3, 4, 5, 5, 4, 5, 4, 5, 5, 4, 4, 4, 5, 4, 4, 5, 5, 5, 4, 4, 4],
    "J3": [5, 5, 5, 4, 5, 5, 5, 3, 3, 5, 4, 4, 5, 5, 4, 3, 4, 4, 5, 5, 4, 4, 4, 4, 4, 4, 5, 4, 5, 5, 5, 4, 5, 4, 4, 4, 5, 5, 3, 5, 5, 5, 5, 5, 2, 5, 5, 4, 5, 4, 5, 5, 4, 5, 4, 4, 5, 5, 5, 5, 5, 5, 3, 3, 5, 5, 5, 4, 4, 5, 5, 4, 5, 4, 5, 4, 4, 4, 5, 3, 5, 4, 5, 5, 5, 4, 5, 5, 4, 4, 4, 4, 5, 5, 4, 4, 4, 5, 3, 4, 4, 4, 4, 4, 5, 4, 4, 4, 4, 4, 4, 5, 5, 5, 4, 4, 4, 4, 4, 5, 4, 5, 5, 5, 4, 3, 5, 5, 5, 5, 4, 5, 5, 5, 5, 4, 5, 5, 5, 4, 5, 5, 4, 5, 4, 4, 5],
    "J4": [4, 5, 4, 4, 5, 4, 5, 5, 3, 5, 4, 4, 5, 5, 4, 4, 4, 4, 5, 4, 5, 4, 4, 5, 4, 4, 5, 4, 5, 4, 5, 4, 5, 5, 5, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 4, 4, 4, 5, 4, 4, 4, 4, 5, 4, 4, 5, 5, 5, 5, 5, 5, 3, 3, 5, 5, 5, 4, 4, 5, 5, 4, 5, 4, 5, 4, 4, 5, 5, 4, 5, 3, 5, 4, 4, 5, 4, 5, 4, 5, 3, 4, 5, 5, 4, 4, 5, 5, 3, 4, 4, 4, 5, 4, 5, 3, 4, 5, 4, 4, 4, 5, 5, 3, 5, 4, 4, 4, 5, 5, 5, 5, 5, 5, 4, 4, 5, 5, 5, 5, 4, 5, 4, 5, 5, 5, 4, 5, 5, 4, 5, 5, 4, 5, 2, 4, 5],
    "J5": [4, 5, 3, 4, 5, 4, 5, 5, 3, 4, 4, 4, 4, 5, 4, 3, 4, 4, 4, 4, 4, 3, 4, 5, 4, 4, 5, 4, 5, 5, 3, 5, 5, 4, 4, 4, 5, 5, 4, 5, 5, 5, 5, 5, 5, 4, 4, 4, 5, 4, 5, 2, 4, 5, 4, 4, 5, 5, 3, 5, 4, 4, 3, 3, 5, 5, 5, 4, 4, 5, 5, 4, 5, 4, 5, 3, 4, 5, 5, 3, 5, 4, 5, 4, 4, 4, 4, 5, 4, 3, 4, 5, 5, 5, 4, 4, 4, 5, 4, 4, 4, 4, 4, 4, 5, 3, 4, 4, 4, 4, 4, 5, 5, 4, 5, 4, 4, 5, 5, 4, 4, 5, 5, 5, 3, 3, 3, 4, 5, 5, 5, 5, 5, 5, 5, 5, 3, 5, 5, 4, 4, 5, 5, 5, 4, 4, 4],
    "C1": [4, 5, 4, 5, 5, 4, 5, 5, 3, 2, 4, 5, 5, 5, 5, 3, 4, 4, 4, 4, 2, 4, 4, 2, 4, 4, 2, 4, 5, 4, 4, 5, 5, 2, 5, 2, 5, 5, 3, 5, 5, 5, 4, 2, 4, 4, 4, 4, 5, 4, 4, 5, 4, 5, 4, 4, 5, 4, 4, 5, 2, 5, 3, 3, 5, 4, 5, 4, 4, 4, 4, 4, 5, 4, 5, 4, 3, 5, 5, 4, 5, 4, 5, 4, 4, 5, 4, 5, 4, 3, 4, 4, 5, 5, 4, 4, 3, 5, 4, 4, 4, 2, 4, 4, 5, 4, 4, 3, 4, 5, 4, 5, 4, 5, 4, 3, 3, 5, 4, 5, 5, 4, 2, 5, 3, 4, 2, 5, 5, 4, 4, 2, 4, 2, 5, 5, 5, 5, 5, 4, 5, 5, 4, 5, 4, 4, 3],
    "C2": [4, 5, 5, 5, 5, 4, 5, 5, 3, 4, 4, 5, 5, 5, 5, 4, 4, 4, 4, 5, 4, 3, 4, 5, 4, 5, 5, 4, 5, 4, 5, 5, 5, 4, 5, 4, 5, 5, 3, 5, 5, 5, 5, 4, 5, 5, 4, 4, 5, 4, 4, 5, 4, 5, 4, 4, 5, 5, 5, 5, 3, 5, 3, 3, 5, 5, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 4, 5, 5, 4, 5, 5, 5, 4, 4, 4, 5, 5, 4, 5, 5, 5, 5, 5, 4, 4, 3, 5, 4, 4, 5, 2, 5, 4, 5, 5, 4, 5, 4, 5, 4, 5, 5, 5, 5, 4, 5, 4, 4, 5, 5, 4, 2, 5, 4, 4, 3, 5, 5, 5, 4, 2, 5, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 4, 4],
    "C3": [4, 5, 5, 5, 5, 5, 5, 5, 4, 5, 5, 5, 4, 5, 5, 4, 4, 5, 4, 5, 4, 4, 5, 5, 4, 5, 5, 5, 5, 5, 5, 5, 5, 4, 5, 4, 5, 5, 3, 5, 5, 4, 5, 3, 4, 5, 5, 4, 5, 4, 4, 5, 4, 5, 4, 4, 5, 5, 5, 5, 4, 5, 3, 5, 5, 5, 5, 5, 4, 5, 5, 4, 5, 4, 5, 4, 4, 5, 5, 3, 5, 4, 5, 4, 5, 5, 5, 5, 4, 4, 5, 4, 5, 5, 4, 4, 4, 5, 4, 4, 4, 4, 5, 4, 5, 5, 5, 5, 4, 5, 4, 5, 5, 4, 4, 3, 5, 4, 5, 5, 5, 4, 5, 5, 4, 5, 3, 5, 5, 5, 4, 5, 5, 4, 4, 5, 4, 5, 5, 5, 5, 5, 4, 5, 5, 4, 4],
    "C4": [4, 5, 5, 5, 5, 4, 5, 5, 4, 5, 5, 5, 5, 5, 3, 4, 4, 5, 4, 5, 4, 3, 4, 5, 4, 5, 5, 4, 5, 5, 5, 5, 5, 4, 5, 4, 5, 5, 3, 5, 5, 5, 5, 3, 3, 5, 4, 5, 5, 4, 5, 5, 4, 5, 4, 4, 5, 5, 5, 5, 5, 3, 3, 5, 5, 5, 5, 5, 5, 5, 5, 4, 5, 3, 5, 4, 4, 5, 5, 4, 5, 3, 5, 5, 5, 5, 5, 5, 4, 5, 5, 5, 5, 5, 4, 4, 4, 5, 4, 5, 5, 4, 4, 4, 5, 5, 4, 5, 4, 5, 4, 5, 4, 4, 5, 4, 5, 5, 5, 5, 5, 4, 5, 5, 5, 5, 3, 5, 5, 5, 4, 5, 4, 4, 4, 5, 5, 5, 5, 4, 5, 5, 4, 5, 5, 4, 4],
    "C5": [4, 5, 2, 3, 2, 4, 2, 2, 4, 2, 3, 3, 5, 5, 2, 2, 2, 2, 2, 2, 2, 5, 2, 5, 2, 2, 2, 2, 3, 3, 5, 4, 5, 2, 4, 5, 5, 2, 3, 2, 5, 5, 2, 2, 2, 5, 2, 2, 3, 4, 5, 5, 2, 5, 2, 4, 5, 5, 2, 2, 2, 2, 3, 4, 5, 5, 5, 5, 3, 3, 3, 4, 5, 2, 5, 4, 4, 2, 5, 3, 5, 2, 5, 2, 2, 2, 4, 5, 4, 5, 2, 3, 2, 3, 4, 2, 2, 5, 4, 2, 2, 2, 2, 2, 3, 3, 2, 2, 4, 5, 4, 5, 3, 3, 2, 2, 2, 5, 2, 3, 4, 2, 2, 5, 3, 5, 5, 2, 5, 2, 3, 5, 3, 2, 4, 5, 3, 5, 5, 5, 5, 5, 5, 5, 2, 4, 5],
    "I1": [5, 2, 4, 2, 2, 4, 3, 5, 4, 5, 3, 3, 5, 5, 2, 3, 2, 2, 4, 2, 4, 3, 2, 5, 2, 2, 2, 2, 3, 3, 2, 4, 5, 2, 2, 2, 5, 2, 3, 5, 5, 5, 5, 5, 2, 3, 2, 2, 3, 4, 3, 2, 2, 2, 2, 4, 5, 2, 2, 2, 5, 2, 3, 3, 5, 2, 5, 4, 4, 3, 4, 4, 2, 4, 4, 4, 4, 2, 5, 3, 2, 5, 5, 3, 2, 2, 4, 5, 4, 3, 2, 3, 3, 5, 3, 4, 2, 5, 4, 3, 2, 2, 4, 4, 3, 3, 2, 3, 4, 4, 4, 5, 5, 3, 2, 2, 3, 5, 4, 2, 4, 4, 3, 3, 3, 3, 5, 2, 5, 2, 3, 2, 3, 2, 4, 5, 4, 3, 5, 4, 5, 5, 4, 2, 2, 4, 2],
    "I2": [4, 5, 5, 5, 5, 5, 5, 5, 4, 4, 4, 5, 5, 5, 4, 3, 4, 5, 4, 4, 4, 4, 4, 4, 4, 5, 5, 4, 5, 5, 5, 5, 5, 5, 5, 4, 5, 4, 3, 5, 5, 5, 5, 5, 5, 4, 5, 4, 5, 4, 5, 5, 4, 5, 3, 4, 5, 5, 5, 5, 4, 5, 3, 3, 5, 5, 5, 4, 4, 5, 5, 4, 5, 4, 5, 5, 4, 4, 5, 4, 5, 4, 5, 4, 4, 5, 4, 5, 4, 5, 5, 5, 4, 5, 5, 4, 4, 5, 4, 4, 4, 2, 4, 4, 5, 5, 4, 3, 4, 4, 4, 5, 4, 4, 5, 4, 4, 4, 3, 4, 5, 5, 5, 5, 4, 5, 3, 5, 5, 5, 4, 4, 4, 4, 4, 5, 5, 5, 5, 4, 5, 5, 5, 5, 4, 4, 5],
    "I3": [4, 5, 4, 5, 5, 4, 5, 4, 4, 4, 5, 4, 5, 5, 5, 3, 4, 5, 4, 4, 4, 4, 4, 5, 4, 5, 4, 4, 5, 3, 5, 4, 5, 5, 4, 3, 5, 5, 3, 5, 5, 5, 5, 5, 5, 4, 5, 4, 4, 4, 5, 5, 5, 5, 4, 4, 5, 4, 5, 5, 4, 5, 3, 3, 5, 4, 5, 5, 4, 5, 5, 4, 5, 4, 5, 4, 4, 5, 5, 4, 5, 4, 5, 5, 4, 5, 4, 5, 4, 4, 4, 4, 4, 5, 5, 4, 2, 5, 4, 4, 4, 2, 4, 4, 5, 5, 4, 5, 3, 4, 4, 5, 4, 4, 5, 5, 4, 4, 3, 4, 4, 5, 4, 5, 3, 5, 3, 5, 5, 5, 3, 5, 5, 4, 4, 5, 3, 4, 5, 4, 5, 5, 4, 5, 4, 4, 4],
    "I4": [4, 5, 4, 5, 5, 4, 5, 5, 4, 4, 5, 4, 5, 3, 5, 4, 4, 4, 4, 5, 4, 4, 4, 4, 4, 5, 5, 4, 5, 4, 5, 4, 5, 5, 4, 4, 5, 5, 3, 5, 5, 5, 5, 5, 5, 4, 5, 4, 4, 4, 5, 5, 3, 5, 4, 4, 5, 5, 5, 5, 4, 5, 3, 3, 5, 5, 5, 4, 5, 5, 5, 4, 5, 4, 5, 4, 4, 5, 5, 5, 5, 4, 5, 5, 5, 5, 4, 5, 4, 4, 5, 4, 5, 5, 4, 4, 4, 5, 4, 4, 4, 2, 4, 4, 5, 5, 4, 4, 4, 4, 4, 5, 4, 5, 5, 5, 5, 4, 4, 4, 4, 4, 3, 5, 4, 5, 3, 4, 5, 4, 4, 4, 5, 4, 4, 4, 3, 5, 5, 4, 5, 5, 5, 5, 5, 4, 3],
    "I5": [4, 5, 5, 5, 5, 4, 5, 4, 4, 5, 5, 4, 5, 5, 4, 3, 4, 4, 4, 5, 4, 4, 4, 4, 4, 5, 5, 4, 5, 5, 5, 5, 5, 5, 5, 4, 5, 5, 3, 5, 5, 4, 5, 3, 5, 4, 5, 4, 5, 4, 5, 5, 5, 5, 4, 4, 5, 5, 5, 5, 4, 4, 3, 5, 5, 5, 5, 4, 5, 5, 4, 4, 5, 4, 5, 4, 4, 5, 5, 4, 5, 4, 5, 5, 4, 4, 5, 5, 5, 5, 4, 5, 5, 5, 5, 4, 4, 5, 4, 4, 4, 4, 4, 4, 5, 4, 4, 4, 4, 4, 4, 5, 4, 3, 5, 5, 4, 4, 4, 4, 4, 4, 5, 5, 4, 5, 3, 5, 5, 5, 4, 4, 4, 4, 5, 4, 4, 5, 5, 4, 5, 5, 5, 5, 5, 4, 3],
    "R1": [4, 5, 4, 5, 5, 4, 4, 5, 4, 2, 5, 4, 5, 5, 5, 4, 4, 5, 5, 4, 4, 4, 5, 4, 4, 3, 5, 4, 5, 4, 4, 5, 5, 4, 5, 5, 5, 5, 3, 5, 4, 4, 5, 5, 4, 4, 5, 5, 4, 4, 4, 5, 5, 5, 4, 4, 5, 5, 3, 5, 4, 5, 3, 3, 5, 5, 5, 5, 4, 4, 5, 4, 5, 4, 5, 4, 4, 4, 5, 4, 5, 4, 5, 5, 4, 4, 4, 5, 5, 4, 4, 4, 5, 5, 3, 4, 4, 5, 4, 4, 4, 2, 4, 4, 5, 4, 4, 4, 4, 5, 4, 5, 4, 3, 5, 5, 4, 4, 5, 5, 4, 4, 5, 5, 3, 5, 3, 5, 5, 4, 4, 5, 4, 4, 5, 5, 4, 5, 5, 4, 5, 5, 5, 5, 4, 4, 3],
    "R2": [4, 5, 3, 3, 2, 3, 3, 2, 4, 5, 3, 4, 5, 5, 2, 2, 2, 2, 2, 2, 4, 4, 5, 4, 4, 2, 5, 2, 5, 3, 3, 5, 5, 2, 4, 2, 5, 5, 3, 5, 5, 5, 2, 5, 2, 3, 2, 2, 4, 4, 4, 2, 2, 3, 2, 4, 5, 2, 3, 2, 5, 2, 3, 3, 5, 2, 4, 4, 4, 2, 4, 4, 2, 3, 4, 4, 4, 4, 2, 4, 2, 3, 5, 2, 4, 3, 2, 5, 5, 3, 2, 3, 3, 4, 3, 2, 3, 5, 4, 4, 3, 2, 3, 4, 3, 4, 4, 3, 2, 5, 4, 5, 2, 3, 2, 3, 4, 4, 3, 2, 4, 4, 3, 5, 3, 3, 5, 2, 5, 2, 2, 4, 3, 4, 5, 5, 4, 4, 5, 2, 5, 5, 4, 5, 2, 4, 4],
    "R3": [4, 5, 5, 4, 5, 4, 5, 5, 5, 5, 5, 4, 5, 5, 5, 3, 4, 5, 2, 4, 4, 4, 5, 4, 4, 4, 5, 4, 5, 5, 5, 5, 5, 4, 5, 5, 5, 5, 3, 5, 5, 5, 5, 5, 5, 4, 5, 4, 4, 4, 3, 5, 2, 5, 4, 4, 5, 4, 4, 5, 4, 5, 3, 3, 5, 5, 5, 5, 4, 5, 5, 4, 5, 4, 5, 4, 5, 4, 5, 5, 5, 5, 4, 4, 4, 5, 5, 5, 4, 4, 4, 5, 4, 4, 4, 4, 4, 5, 4, 2, 4, 4, 5, 4, 5, 5, 4, 4, 4, 5, 4, 3, 4, 4, 4, 4, 4, 5, 4, 4, 5, 5, 3, 4, 3, 5, 5, 4, 3, 5, 4, 4, 4, 5, 4, 5, 5, 3, 5, 5, 5, 5, 4, 4, 4, 4, 4],
    "R4": [4, 5, 4, 5, 5, 4, 5, 5, 4, 5, 5, 4, 5, 5, 5, 4, 4, 5, 4, 4, 4, 4, 5, 4, 4, 5, 5, 4, 5, 5, 5, 5, 5, 2, 5, 5, 5, 5, 3, 5, 5, 5, 5, 4, 5, 4, 5, 4, 5, 4, 4, 5, 4, 5, 4, 4, 5, 5, 4, 5, 4, 5, 3, 3, 5, 5, 4, 5, 4, 5, 5, 4, 5, 4, 5, 4, 4, 4, 5, 4, 5, 5, 5, 4, 5, 5, 4, 5, 5, 5, 5, 4, 5, 5, 4, 4, 4, 5, 4, 4, 5, 2, 4, 4, 5, 3, 4, 5, 4, 4, 4, 5, 5, 4, 4, 5, 4, 4, 4, 4, 4, 4, 3, 5, 4, 5, 3, 5, 5, 4, 5, 4, 5, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 4, 2],
    "R5": [4, 5, 4, 5, 5, 4, 5, 5, 4, 5, 5, 5, 5, 5, 4, 4, 4, 5, 4, 4, 4, 4, 4, 4, 4, 4, 5, 4, 5, 5, 5, 5, 5, 3, 5, 5, 5, 5, 3, 5, 5, 5, 5, 4, 5, 4, 5, 4, 5, 4, 4, 4, 4, 5, 4, 4, 5, 5, 4, 5, 4, 5, 3, 3, 5, 5, 5, 5, 4, 5, 5, 4, 5, 4, 5, 4, 4, 5, 5, 4, 5, 4, 5, 5, 4, 4, 4, 5, 5, 5, 4, 4, 5, 5, 4, 4, 4, 5, 4, 4, 4, 2, 5, 4, 5, 4, 4, 4, 4, 4, 4, 5, 4, 2, 5, 4, 4, 2, 4, 5, 4, 4, 4, 5, 3, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 4, 5, 5, 5, 5, 5, 4, 4],
}

# Crear un DataFrame con la data
df = pd.DataFrame(data)

# Calcular el KMO
kmo_all, kmo_model = calculate_kmo(df)

# Calcular la prueba de esfericidad de Bartlett
chi_square_value, p_value = calculate_bartlett_sphericity(df)

# Crear la tabla de resultados
results = {
    "Medida": ["Medida Kaiser-Meyer-Olkin de adecuación de muestreo", "Prueba de esfericidad de Bartlett"],
    "Valor": [f"{kmo_model:.3f}", ""],
    "Aprox. Chi-cuadrado": ["", f"{chi_square_value:.3f}"],
    "gl": ["", "136"],  # Este es un valor de ejemplo, ajusta según tu caso
    "Sig.": ["", f"{p_value:.3f}"]
}

df_results = pd.DataFrame(results)

# Mostrar la tabla usando matplotlib
fig, ax = plt.subplots(figsize=(8, 2))  # Ajusta el tamaño de la tabla
ax.axis('tight')
ax.axis('off')
table = ax.table(cellText=df_results.values, colLabels=df_results.columns, cellLoc='center', loc='center')
table.auto_set_font_size(False)
table.set_fontsize(12)
table.scale(1.2, 1.2)

plt.title('Prueba de KMO y Bartlett', fontsize=14)
plt.show()
